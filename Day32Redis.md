# Redis

＃＃＃　Ｒｅｄｉｓ解决三高问题：高并发，高海量，高可用



## Redis五种数据类型

| Redis  | 支持的键值数据类型 |
| ------ | ------------------ |
| string | 字符串类型         |
| hash   | 表类型             |
| list   | 列表类型           |
| set    | 集合类型           |
| zset   | 有序集合类型       |

### 字符串类型String

* Redis都是二进制进行保存，没有编码和解码

#### 常用命令

1. set 键 值
2. get 键 
3. del 键



### 哈希类型

* 在Redis中的Hash类型可以看成具有String的键和值的Map容器，每一个Hash中大约可以存储40亿个键值对。

#### 常用命令

1. hset 键 字段 值   （向指定的键添加一对hash类型的字段名和值
2. hget 键 字段   （去除指定键的指定字段的值）
3. hmset 键 字段 值 字段 值 (multiple,一次向某个键中设置多个字段名和值)
4. hmget 键 字段 字段  （一次从指定的键中得到多个字段的值）

5. hdel 键 字段 字段  删除一个键中的一个或多个字段
6. hgetall 键   （得到某个键所有的字段值）



### 列表类型

#### 常用命令

1. lpush 键 元素 元素  left push 在列表的左边向指定的键中添加列表元素，如果该键不存在，Redis将为该键创建一个新的链表，
2. rpush 键 元素 元素  在列表的右边添加元素
3. lpop 键 left pop 从指定键中的左边弹出一个元素，列表中的元素就删除了
4. rpop 键 right pop 从指定键的右边弹出一个元素，列表中的元素就删除了。
5. lrange 键 开始  结束 从指定的列表中去除指定的元素列表，从左边数起从0开始，从右边数起从-1开始。<font color="red">如果要取整个列表，开始是0，结束时-1</font>
6. llen键 的到指定列表的长度



### 集合类型 set

#### 常用命令

1. sadd 键 元素 元素   向set集合中添加1个或者多个元素
2. smembers 键  查询指定的集合中所有的元素
3. sismember 键  元素     判断指定的元素是否在某个集合中，如果存在返回1，否则返回0
4. srem 键 元素 元素   remove 删除指定的一个或者多个元素



###  Redis的通用命令

#### 常用命令

1.  keys 匹配字符   ----查询当前数据库中有哪些键 
    1.  （*）匹配多个字符
    2.  （？）匹配一个字符
2.  del 键1 键2 可以删除任意键，可以一次删除多个键
3.  exists键  ---- 是否存在指定的键
4.  type键  ----- 判断指定的键它的值时什么类型，如：String，list, hash, set, none
5.  select 数据库编号选择指定的数据库，0-15
6.  move 键  数据库标号

### Redis 的持久化

#### Redis持久化的两种方式

1. RDB格式： Redis DataBase，每过一段时间将内存中的数据写在硬盘上面
2. AOF格式： Append Only File，以日志的方式记录服务器上的每个操作，当服务器重启的时候，将日志中的操作还原到内存中。

#### RDB持久化的优点和缺点：

| 优点           | 缺点                   |
| -------------- | ---------------------- |
| 方便恢复和备份 | 不能完全避免数据丢失   |
| 性能最大化     | 会导致服务器暂停的现象 |
| 启动效率更高   |                        |
|                |                        |

* RDB持久化机制的配置

  * 在redis.windows.conf配置文件中的SNAPSHOTTING快照中有如下说明：

    * save<时间间隔><修改键数> 在指定的时间间隔内，修改了多少键，则进行持久化操作
* 例子：（save 900 1）在15分钟内如果修改了1个键，则进行持久化操作
    * 例子： (save 300 10) 在5分钟内如果修改了10个键，则进行持久化操作
* ![1564647770827](D:\note\就业班笔记\Day32Redis.assets\1564647770827.png)

### AOF持久化机制优缺点

| 优点                           | 缺点                |
| ------------------------------ | ------------------- |
| 更高的数据安全性               | 文件比RDB大         |
| 所有的持久化操作都是异步完成的 | 运行效率比RDB更慢， |
|                                |                     |
|                                |                     |

#### 开启AOF持久化

* appendonly no/yes    yes表示开启持久化，no表示关闭，默认时关闭
  * 如果开启会在硬盘上生成一个文件 appendonly.aof
*  AOF持久化时机
* ​              always  每次修改都持久化，效率最低

​              /

  appendfsync  —— everysec  每秒 持久化一次

​		     \ 

​				no  不持久化，效率最高

* no-appendfsync -on -rewrite yes 正在到处rdb快照的过程中，要不要停止aof



### jedis的基本使用

